<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalle del Pedido</title>
</head>
<body>
<h1>Detalle del Pedido #<?= htmlspecialchars($order->getOrderNum()) ?></h1>
<nav>
    <a href="/">Inicio</a> |
    <a href="/clientes">Clientes</a> |
    <a href="/pedidos">Pedidos</a> |
    <a href="/productos">Productos</a>
</nav>
<hr>

<h2>Información del Pedido</h2>
<table border="1">
    <tr>
        <th>Número Pedido:</th>
        <td><?= htmlspecialchars($order->getOrderNum()) ?></td>
    </tr>
    <tr>
        <th>Fecha Pedido:</th>
        <td><?= $order->getOrderDate() ? htmlspecialchars($order->getOrderDate()->format('d-m-Y')) : '-' ?></td>
    </tr>
    <tr>
        <th>Tipo:</th>
        <td><?= htmlspecialchars($order->getOrderType() ?? '-') ?></td>
    </tr>
    <tr>
        <th>Cliente:</th>
        <td><?= htmlspecialchars($order->getClient()->getName()) ?>
            (Código: <?= htmlspecialchars($order->getClient()->getId()) ?>)
        </td>
    </tr>
    <tr>
        <th>Fecha Envío:</th>
        <td><?= $order->getShipDate() ? htmlspecialchars($order->getShipDate()->format('d-m-Y')) : '-' ?></td>
    </tr>
    <tr>
        <th>Total:</th>
        <td><strong><?= $order->getTotal() !== null ? number_format($order->getTotal(), 2) . ' €' : '-' ?></strong></td>
    </tr>
</table>

<h2>Detalles del Pedido</h2>
<table border="1">
    <tr>
        <th>Nº Detalle</th>
        <th>Producto</th>
        <th>Precio Venta</th>
        <th>Cantidad</th>
        <th>Importe</th>
    </tr>
    <?php
    $details = $order->getDetails();
    if ($details->isEmpty()):
    ?>
    <tr>
        <td colspan="5">No hay detalles para este pedido</td>
    </tr>
    <?php else: ?>
    <?php foreach ($details as $detail): ?>
    <tr>
        <td><?= htmlspecialchars($detail->getNumDetail()) ?></td>
        <td><?= htmlspecialchars($detail->getProduct()->getDescription()) ?>
            (ID: <?= htmlspecialchars($detail->getProduct()->getId()) ?>)
        </td>
        <td><?= $detail->getPrice() !== null ? number_format($detail->getPrice(), 2) . ' €' : '-' ?></td>
        <td><?= htmlspecialchars($detail->getQuantity() ?? '-') ?></td>
        <td><?= $detail->getAmount() !== null ? number_format($detail->getAmount(), 2) . ' €' : '-' ?></td>
    </tr>
    <?php endforeach; ?>
    <?php endif; ?>
</table>
</body>
</html>